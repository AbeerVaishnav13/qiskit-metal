# Softwares to Install for Open-source simulation toolchain for Qiskit Metal

## Qiskit Metal (`elmer_rednerer` branch)
### Steps to reinstall Qiskit Metal with proper interfacing code

1. Clone a fresh copy of the Qiskit Metal GitHub repo in your working directory
```
$ mkdir metal-simulation && cd metal-simulation
$ git clone https://github.com/Qiskit/qiskit-metal.git
```
2. Go into the newly cloned repo, and do a `git fetch` and then change the branch to `elmer_renderer`
```
$ cd qiskit-metal
$ git fetch origin
$ git checkout elmer_renderer
```
3. Install `virtualenv` python package and make a new `venv` environment, activate it, and install the package.
```
$ pip install -U virtualenv
$ python -m venv <env_name>
$ source <env_name>/bin/activate
$ pip install -U pip
$ pip install -e .
```
**NOTE:** Don't forget to put the '.' in the last step as that is important for completing the installation.

4. This should install all the necessary python packages needed for doing the simulations.

## Gmsh
- This is a drawing and meshing software that we will be using to render our design and then divide it into fine elements (called a `mesh`), in order to solve the necessary differential equations (PDE's of Maxwell's Electromagnetic Laws). This is completely integrated with Qiskit Metal and is semi-automated.
- This will be automatically installed when you make a new `venv` environment and install qiskit metal using the instructions given above (except in Apple Silicon Macs, see the Note below).

### Test out if Gmsh is properly installed
- Run the following in your terminal. A blank Gmsh window should open up. If it does, then hurray, you did it! :D
```
$ gmsh
```

- Open a python REPL in your terminal and type `import gmsh` in the REPL. If `gmsh` gets imported without any errors, then it's installed properly with python.
```
$ python
Python 3.9.7 (default, Sep 13 2021, 08:18:39)
[GCC 8.5.0 20210514 (Red Hat 8.5.0-3)] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import gmsh
>>>
```

**NOTE:**
- On Apple Silicon Macs (with M1 and M2-series chips), installing Gmsh using `pip install` might not work for importing the package using python. Instead use [Homebrew](https://brew.sh/) to install Gmsh as follows:
```
$ brew install gmsh
```
- Then use `$ which gmsh` to find the path to your installed `gmsh` executable. This command will return something of the form `<install_path_on_your_system>/bin/gmsh`. Add the path until `<install_path_on_your_system>/bin` to your `PATH` environment variable. Restart your terminal, and check if you're able to do `import gmsh` in a scratch jupyter notebook. If the import is successful, then congratulations, you've installed Gmsh successfully!

## ElmerFEM
- Congratulations on making it until here! Now we'll see how to install ElmerFEM.
- ElmerFEM is a Finite Element Method (FEM) solver that we'll be using to take the mesh generated by Gmsh, and the solve the Maxwell's equations on top of our meshed design. Right now, Qiskit Metal only supports capacitance-type simulations with ElmerFEM, so only qubits can be tuned with this using the LOM 2.0 analysis (part of Qiskit Metal) on top of the results obtained from ElmerFEM in the form of a `Maxwell Capacitance Matrix`.
- Sadly, this doesn't come as a python library and has different installation options on different operating systems.
- Please follow the official guide provided by Elmer Foundation CSC, [here](https://github.com/ElmerCSC/elmerfem#elmer-fem)

**NOTE:** Please consider building the software from source rather than using Homebrew on Mac, as the homebrew install isn't very consistent.

### After you complete your installation
- Add your installation path directory to your system's `PATH` environment variable.
- Restart your terminal
- Check if ElmerFEM is installed successfully by typing `ElmerGrid`. It will print a long text. Check if you see the following at the end of the text:
```
...
...
Thank you for using Elmergrid!
Send bug reports and feature wishes to elmeradm@csc.fi
```
If you see the above lines in the text in your terminal, then CONGRATULATIONS!!! You've successfully installed everything needed for using the first-ever open-source simulation toolchain for Qiskit Metal!

Finally, if you face issues at any of the steps above, feel free to contact us on #metal channel on Qiskit slack!!